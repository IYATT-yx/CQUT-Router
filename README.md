# CQUT router
针对重庆理工大学宽带的路由器固件 - 解除一个帐号一台设备使用的限制  

_____________________________________________
2021-4-9  
[固件](固件)  
目前编译了斐讯K2和newifi3的固件（https://github.com/openwrt/openwrt 21.098）  
从2.1g1开始集成了使用创翼所需的脚本（基于https://github.com/miao1007/Openwrt-NetKeeper ）和 PPPoE 服务器  
只需要登录管理页面,打开 服务->终端,在里面执行 `sh nk4conf.sh` 即可启用  

方案:  
电信创翼登录本身就是 PPPoE 拨号，只是动态加密帐号（尚不知加密算法），路由器集成了 rp-pppoe-server。当电脑连接到路由器后，在电脑上使用创翼登录，路由器上的PPPoE服务器会收到拨号请求，利用 debug 模式将登录帐号和密码保存到一个文件中，路由器上检测文件中的帐号密码是否变化。如果变化了，就将新的帐号和密码用于路由器进行PPPoE拨号（向宽带服务器）。  
总结一句话就是，路由器伪装是宽带服务器，创翼拨号的时候欺骗得到加密后真正的帐号，然后代替创翼去登录。  

管理页面地址 `192.168.6.1` 或 `http://IYATT-yx.lan`  
wifi名和密码都是:  iyatt.com  

g1 为 K2  
g2 为 newifi3  
____________________________________________
2021-4-10

2.14g1 2.15g2 去除adblock
____________________________________________
2021-4-11

2.16g2 去除cshark
____________________________________________
2021-4-11

2.15g1 2.17g2 添加TCP-BBR
____________________________________________
2021-4-11

2.16g1 2.18g2 修改脚本
启用创翼支持命令改为 `sh nkconf.sh`
____________________________________________
____________________________________________
2021-5-8  

重新克隆 OpenWrt 源码，采用版本 21.127  
部分APP来源：[openwrt-packages](https://github.com/caonimagfw/openwrt-packages)   
____________________________________________
____________________________________________
2021-5-13

2.20g1   

WiFi 预置配置文件，区域设置为 CN  
内核未再添加 TCP-BBR  
未再添加 nft-qos  
脚本可直接运行  `./install.sh`  
时区预置为 Asia/Shanghai 
添加 UPnP  
添加 Turbo ACC 网络加速（flow、bbr、fullcone nat、dns）  
____________________________________________
2021-5-14  

2.20g2
内核未再添加 TCP-BBR  
未再添加 nft-qos  
脚本可直接运行  `./install.sh`  
时区预置为 Asia/Shanghai  
WiFi 预置配置文件，区域设置为 CN  
添加 UPnP  
添加 Turbo ACC 网络加速（flow、bbr、fullcone nat、dns）  

添加 [aliddns](https://github.com/honwen/luci-app-aliddns)  
{  
   背景：学校的宽带拨号成功以后可以获得公网 IP，但是如果断开再次拨号 IP 就会改变，如果本地搭建有互联网服务，比如网站，每次拨号 IP 都变，记忆 IP 很麻烦，因此可以使用 DDNS，因为我自己使用的关系，DDNS 只加了这个;  
   条件：需要注册[阿里云](https://account.aliyun.com/)帐号，以及有一个域名。
   使用：进入“云解析 DNS”将自己的域名添加进去（如果就是在阿里云买的域名，里面直接就有了）。不是必需要备案域名，因为没有备案的域名一般只是拦截 WEB 端口（80、443等），而且这个宽带虽然有公网 IP，但是本身也是封掉WEB端口的（需要在 信息通信管理局 备案才能用），所以 WEB 端口就别想用了，但是不影响应用服务，只是默认，还不能不用默认的吗。然后在阿里云创建一个“AccessKey”，创建好之后将 ID 和 screct 填到“阿里云DDNS”里就行，这样就能不登录阿里云帐号的情况下通过阿里云的接口进行DNS解析修改（RAM 控制），然后填上你的域名，和要使用的子域名。还有个时间设置，就是检测 IP 的周期，每过一段时间检测一次 IP，如果变了，就通过阿里云的接口修改域名解析。  
   如果不会用，可以自己使用搜索引擎找别人的图文教程，不过我也相信既然都弄这个东西了，还是有一定基础。    
}  
  
USB 储存设备支持（文件系统：ext4、vfat、exFat、ntfs），在 `系统->挂载点` 中勾选 `自动挂载未配置的磁盘分区` ，插入 USB 储存设备会自动挂载到 /mnt 下   

ftp 服务器支持，在 Windows 资源管理器以及 Ubuntu 文件管理器中都能进行连接，直接复制粘粘操作等。结合 USB 支持以及 DDNS可实现远程文件操作。  

____________________________________________